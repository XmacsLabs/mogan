# 202_65 修复 item-nr 并 添加 rendering options for tag（局部变量）选项

## 如何测试
测试文件在 `mogan/TeXmacs/tests/tmu/202_65.tmu`
- 插入 -> 有序列表 -> 默认（快捷键：`1 + . + tab`）
- 在 focus toolbar 里的按钮 `rendering options for tag(齿轮图标)`里选择`item-nr`，任意勾选或设置值,观察编号是否从设置的值的下一个开始
- 然后再创建一个有序变量环境，看`item-nr`的设置是否独立

## 2025/11/18
### What
现在逻辑是：
  - 当enumerate-level=1时（顶层列表），使用用户设置的item-nr
  - 当enumerate-level>1时（子列表），使用默认值0

  这样顶层列表可以设置item-nr，子列表会从1开始，但是子列表无法设置item-nr。
  这个方案应该能解决子列表继承父列表编号的问题，同时保持顶层列表的item-nr设置功能。

### How
```
<\with|current-item|<arg|item-render>|transform-item|<arg|item-transform>|item-nr|<value|item-nr>>
```
改为
```
<\with|current-item|<arg|item-render>|transform-item|<arg|item-transform>|item-nr|<if|<equal|<value|enumerate-level>|1>|<value|item-nr>|0>>
```


## 2025/11/3
### How
- 在 `generic-menu.scm` 中新增渲染菜单（即rendering options for tag）的辅助分区，集中放置局部参数的特殊处理逻辑。
- 通过 `rendering-parameters-merge` 将 `item-nr` 自动补充到局部菜单，避免每次手写拼接。
- 抽象出 `parameter-item-nr-set`，从当前光标向上查找所属条目与列表节点，先清理条目级 `with|item-nr|...` 覆盖，再把值写回列表作用域。
- `parameter-local-special-set` 负责调度局部渲染参数的专用 setter，后续新增参数时只需在该分支扩展即可。

