# 选择性粘贴功能实现

## 如何测试
+ 打开 Mogan STEM，选择菜单栏 **编辑->选择性粘贴...**，查看是否弹出选择性粘贴窗口
+ 使用 **Ctrl+Alt+v**，快捷键，查看是否弹出选择性粘贴窗口
+ 切换为数学模式，打开选择性粘贴窗口，查看左侧提示是否改变为 “数学模式”；退出数学模式，再次打开选择性粘贴窗口，查看左侧提示是否改变为 “文本模式”。
+ 打开选择性粘贴窗口，查看下方说明信息是否与右侧选中项相符合；切换选中项，查看下方说明信息是否变化；切换为数学模式，重复本行测试。
+ 选择 Markdown 格式，点击确定，查看是否跳转到 Mogan STEM 官网。
+ 复制对应格式，使用选择性粘贴窗口进行粘贴，查看功能是否正常。
+ 新建两个标签页，将其中一个拖出，在两个窗口中分别打开选择性粘贴窗口，查看tips功能是否正常

注：社区版不支持markdown与OCR功能，故虽有选项但无法使用。

## 2025/12/27

### What

同时打开多个选择性粘贴窗口，会出现变量共用的问题，这是由于使用了全局变量的缘故，现在将相关变量改为局部变量以修复问题。

## 2025/12/12

### What
初步实现选择性粘贴功能，包括：
+ 实现基础功能：选择格式进行粘贴
+ 可以使用菜单项与快捷键呼出选择性粘贴窗口
+ 能够检测当前光标所处位置的模式，比如文本模式与数学模式
+ 可以根据当前模式展示不同的格式选择菜单
+ 可以根据当前选项展示不同的提示说明
