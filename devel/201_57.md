# [201_57] 修复qq输入法在数学模式下crash的问题

## 如何测试
- 在普通模式下，用中文输入法打字，编辑器中应该有preedit显示
- 在数学模式下，用中文输入法输入a，编辑器应该没有preedit显示，并且继续按下tab后不会crash

## 2026/1/16
### What 
用qq输入法使用tab补全敲符号的时候会出现crash的问题，与preedit相关

现在数学模式下进入中文输入的preedit

### How
在 `src/Plugins/Qt/QTMWidget.cpp` 中 im_preedit_switch 变量设置时，增加判断：
```cpp
// Disable preedit in math mode to prevent crash in QQPinyin
if (as_bool (call ("in-math?"))) im_preedit_switch= false;
```