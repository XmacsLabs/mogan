# 200_29: 新增pre-commit钩子防止在main分支提交

### What
在项目根目录创建 `hooks/pre-commit` 钩子脚本，并通过 `bin/code` 启动脚本自动检测和安装，防止开发者在 main 分支上意外提交代码。

### Why
- 防止开发者意外在 main 分支上提交代码，避免污染主分支
- 强制要求使用开发分支进行日常开发工作
- 通过自动化安装机制确保所有开发者都能获得相同的钩子保护

### How
1. **钩子实现**：在 `hooks/pre-commit` 中实现分支检查逻辑
   ```bash
   #!/bin/bash
   current_branch=$(git branch --show-current)
   if [ "$current_branch" = "main" ]; then
       echo "错误：不允许在main分支上进行提交！"
       echo "请切换到其他分支进行开发。"
       exit 1
   fi
   exit 0
   ```

2. **自动安装**：通过 `bin/code` 启动脚本自动检测和同步钩子
   - 检查 `hooks/pre-commit` 是否存在
   - 比较并同步到 `.git/hooks/pre-commit`
   - 设置正确的执行权限

3. **启动流程**：开发者通过 `bin/code` 启动 Claude Code 时自动完成钩子安装

该实现确保了钩子的版本控制和自动部署，无需手动安装即可为所有开发者提供保护。