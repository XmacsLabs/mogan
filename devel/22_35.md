# 22_35 防止会话菜单项被翻译


## 2025/11/19

### What
本次修改解决了 文档->主题 下拉菜单中的选项不应该被翻译的问题

### How
通过在菜单定义中使用`verbatim`标记包装菜单项名称，防止翻译系统对这些文本进行翻译。对`theme-menu.scm`文件进行修改。



## 2024/11/07

### What
本次修改解决了会话菜单项被错误翻译的问题，确保了以下影响：

1. 解决了技术术语在不同语言环境下保持一致显示的问题
2. 对系统的影响范围仅限于会话菜单的显示方式，不影响任何功能逻辑
3. 验证方法：在多语言环境下打开Mogan/TeXmacs，检查会话菜单中的技术术语是否保持英文原始显示
4. 兼容性考虑：此修改与现有代码完全兼容，不需要其他相关文件的更改

此修改提高了跨语言环境下用户界面的一致性和专业术语的准确性，使不同语言背景的用户都能识别相同的会话类型。

### Why
为了保持Mogan/TeXmacs中会话菜单的一致性和技术术语的准确性，需要确保菜单项中的会话类型名称（如Scheme、Python等）不会被翻译系统处理。技术术语的翻译可能导致用户体验不一致，特别是在跨语言环境下。

### How
通过在菜单定义中使用`verbatim`标记包装菜单项名称，防止翻译系统对这些文本进行翻译。修改了`session-menu.scm`文件中的两个关键位置：

1. 当会话只有默认连接变体时的菜单项定义
2. 当会话有多个连接变体时的菜单项定义和子菜单项定义

涉及的文件：
- `TeXmacs/progs/dynamic/session-menu.scm`

关键代码变更：
```scheme
# 从原来的直接使用菜单项名称
((eval menu-name) (make-session name "default"))

# 修改为使用verbatim包装菜单项名称
((eval `(verbatim ,menu-name)) (make-session name "default"))
```

```scheme
# 从原来的直接使用菜单项名称
(-> (eval menu-name)
    (for (variant l)
      ((eval variant) (make-session name variant))))

# 修改为使用verbatim包装菜单项名称
(-> (eval `(verbatim ,menu-name))
    (for (variant l)
      ((eval `(verbatim ,variant)) (make-session name variant))))
```

技术实现细节：
- 使用Scheme的准引用（quasiquote）和反引用（unquote）语法（`和,）动态生成带有verbatim标记的菜单项
- verbatim标记是Mogan/TeXmacs中用于表示不应被翻译的文本的特殊标记
- 修改后的代码保持了原有的菜单结构和功能，仅增加了防翻译标记
