# [202_38] 保存或加载文件权限不足时更好的提示和动作

## 如何测试

1. 编辑一个只读文件，保存，查看弹出的选项，检查有另存为选项。确定另存为可用。
2. 编辑一个不可读文件，能够看到查看弹出的提示框。

## 2025/09/28 窗口大小换用guipx位单位

修改了整体按钮的样式，包括只读文件的按钮样式，使用guipx为单位能更好的适配不同dpi。
其中，guipx 是 TeXmacs 定义的一个内置长度单位，用于界面/宏中指定“GUI 像素”类的尺寸。具体的数值转换在文件`env_length.cpp`的`edit_env_rep::exec_guipx_length()` 中实现。

## 2025/09/28 修复了打开中文名文件时，[只读]变为utf-8编码的问题

## 2025/09/25 打开只读文件需要更好地给用户提示

### What

从微信下载的tmu文件，经常是只读的，此时保存会提示无法写入。需要明确提示用户，这个文档的权限为只读权限，告诉用户可以先另存为，如果一定要更改当前文档，那么需要将文档的权限从只读设置为可写。

### Why

增强 UX

### How

修改 `buffer_import` ：打开文件后，判断是否只读，然后在显示标题时在前面加上“只读”。
另外，修改了试图保存只读文件时的弹窗，目前还需修改样式。

## 2025/09/09 不可读时弹窗提示

### What

加载不可读文件时弹窗明确提示，而非在底部消息栏中。

### Why

增强 UX

### How

使用 `show-message` 而非 `set-message`。


## 2025/09/08 支持另存为

### What

支持保存只读文件时提示用户无法写入，可以另存为，当用户确定时弹出另存为的窗口。

### Why

增强 UX

### How

在 `cannot-write?` 中判断，恢复可修复的错误。

