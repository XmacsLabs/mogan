# 222_36 修复数学补全 Tab cycling 弹窗在大符号后位置异常

## 如何测试

在 mogan 中插入“数学-单行公式”，输入大算符（如 \\iiint），然后按 `I` `I` `Tab` 触发 tab cycling。弹窗应出现在光标附近，而不会被推到很右侧。

## 2026/01/28 
### Why

数学补全弹窗的位置基于缓存的光标坐标计算，在遇到 `math-big-operator` 包裹的大符号时，字形 extents 异常放大，导致 `cached_cursor_x` 极大，弹窗被推到很右侧。

### What

改为优先使用 `QTMWidget` 里真实的光标像素坐标进行定位，并在不可用时回退旧的缓存坐标计算，避免被大符号字形影响。

### How

- `QTMWidget` 暴露只读的 `cursorPos()` 供弹窗取用。
- `QTMMathCompletionPopup::getCachedPosition` 首选 `cursorPos + origin + surface` 的几何关系计算位置，兜底保留原有计算逻辑。



