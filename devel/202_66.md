# 202_66 优化listing
## 2024/11/10

## 如何测试

测试文件在 `mogan/TeXmacs/tests/tmu/202_66.tmu`

- 清除缓存 
  - Windows下是先在文件资源管理器里的地址输入框里输入 `%appdata%`，然后删除 `AppData/Roaming/MoganLab` 和 `AppData/Local/MoganLab`。
  - Linux下是删除 `.cache/MoganLab`。
  - macOS下是删除 `~/Library/Caches/MoganLab`。

## what
- 删除原先的`listing`，改成基于`numbered`实现的新的`listing`，这个pr先提供了纯文本和cpp高亮，界面按钮在`插入->程序`里。
- 为`numbered`提供界面按钮，在`插入->编号`里。（因为`numbered`本身就有翻译是`编号`）

## why
写论文的时候源代码在 LaTex 里常用 listings 宏包，Mogan 里虽然有`numbered`，但是需要手动一行一行加代码环境，体验比较差

## how
新增`ext-numbered-prog`，在原先`ext-numbered`的基础上支持多加一个参数。

```
  <assign|cpp-listing|<\macro|body>
    <\with|dummy1|<value|numbered-offset>|dummy2|<value|numbered-color>|dummy3|<value|numbered-font-size>>
      <extern|ext-numbered-prog|<quote-arg|body>|cpp>
    </with>
  </macro>>
```
这是`cpp-listing`的宏