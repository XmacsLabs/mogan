# 201_52 辅助窗口优化

## 如何测试 
1. 点击`工具->宏命令->新建宏`，光标被传入宏编辑器的输入框，点击确认，窗口被关闭，同时光标被传出主文档。
2. 点击`文档->页眉页脚`，光标被传入第一个输入框，点击确认，窗口能正常被关闭，同时光标被传出主文档。
3. 点击`格式->页面`，光标传入第一个输入框，点击确认,窗口能正常被关闭，同时光标被传出主文档。
4. 对于`编辑->查找`和`编辑->替换`以及上面这三个窗口，任意打开这五个辅助窗口中的其中一个，在不关闭窗口的情况下切换其他窗口，观察窗口能否被正常切换。
5. 打开任意一个辅助窗口，当光标位于辅助窗口中的输入框时，`插入->注记->折叠的批注`无法执行。
6. 新建标签页并拉出成为一个独立的窗口，两个窗口都任意打开一个辅助窗口，在不关闭辅助窗口的前提关闭掉主窗口，观察程序是否还能正常运行。

## 2026/1/14 修复多个窗口同时打开辅助窗口后关闭窗口时产生的问题

## 2026/1/13 修复无法实时切换辅助窗口的问题

### what
当打开辅助窗口后，如果此时光标位于辅助窗口内部的输入框，这时候再打开其他辅助窗口，这时由于当前的焦点是位于辅助窗口
内部的输入框内，就会导致其他辅助窗口的打开失败，因此只需要在打开辅助窗口的时候强制切换焦点到主文档,就能保证可以正常切换过去。

## 2026/1/12 打开关闭辅助窗口时传入传出光标

## 2026/1/12 设置页眉页脚和宏编辑器辅助窗口状态

## 2026/1/12 宏编辑器打开关闭时传入传出光标