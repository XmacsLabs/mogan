# 204_18 优化 图片及题注 与 表格及题注

## 如何测试
- 清除缓存 
  - Windows下是先在文件资源管理器里的地址输入框里输入 `%appdata%`，然后删除 `AppData/Roaming/MoganLab` 和 `AppData/Local/MoganLab`。
  - Linux下是删除 `.cache/MoganLab`。
  - macOS下是删除 `~/Library/Caches/MoganLab`。
- 测试文档：Texmacs/tests/tmu/204_18.tmu
  - 分别测试最下面的工具栏里的功能
    - T(toggle name)
    - 123(toggle numbering)
    - 扳手里的 captions above
  - 其中 captions above 原先是 figure 和 table 同步切换的，现在是各自独立的

## 2025/12/26 修复Captions above导致的死循环崩溃
### What
每一个TMU文档的开头会有style项目，描述该文档需要导入的style-package，例如中文文档会使用chinese package。
但是，在上一次的修改中，chinese package内容中新增如下行：
```
<use-package|table-captions-above>
```
这意味着table-captions-above package会跟随chinese一同被**间接**导入。
当用户点击“扳手里的Captions above”时，软件会尝试**直接**导入 table-captions-above package，但由于其已经被间接导入，因而出错。
只需将此行删除，通过 “扳手里的Captions above” 就能顺利启用/禁用 table-captions-above package，进而实现预期效果。
测试小提示：打开测试文档，开关 图片/表格 中 “扳手里的Captions above”，保存文件，用文本编辑器观察TMU文件头部style的变化

### Why
See issue: [在中文文档中，table 使用 captions above 会死循环](https://github.com/XmacsLabs/mogan/issues/2279)

## 2025/12/15 分离 figure 和 table
### What
以前的 图片及题注 与 表格及题注 是在同一个逻辑下的，都是通过 new-figure 生成，但是figure的题注是在下面，table的题注是在上面，过去只是在宏定义上修改了 render-small-figure 和 render-big-figure，使用的时候自命名功能使用不了，上下位置切换两个会同步。